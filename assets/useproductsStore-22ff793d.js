import{B as i,z as c}from"./index-f18f38fe.js";const d=i("commodityStore",{state:()=>({commidity:{},product_id:"",img_train:[],addTocartcheck:[],orderListId:"",orderUser:{},ordermessage:"",paidstate:!1,confirmaddCart:!1,confirmupdateCart:!1,navbargetCartLength:!1}),getters:{},actions:{getCommidity(t){console.log("getID",t),this.product_id=t,this.$router.push(`/commodity/${this.product_id}`),this.getImgTrain()},getImgTrain(t){const e=n();this.product_id=t;const o=e.rowData.filter(r=>r.id!==this.product_id).map(r=>({imageUrl:r.imageUrl,id:r.id})),a=o.filter((r,s)=>s<3);this.img_train=[...o,...a],console.log("this.img_train",this.img_train)},getCart(){const t="https://vue3-course-api.hexschool.io/api/chillstore_api/cart";return c.get(t).then(e=>{e.data.success&&(this.addTocartcheck=e.data.data.carts)})},async addCart(t,e){console.log("新增的內容",t,e),await this.getCart(),console.log("this.addTocartcheck",this.addTocartcheck);const o=this.addTocartcheck.filter(a=>a.product.id===t);if(console.log("exitid",o),o.length<1){console.log("走新增");const a="https://vue3-course-api.hexschool.io/api/chillstore_api/cart";c.post(a,{data:{product_id:`${t}`,qty:e}}).then(r=>{console.log("addCart-res",r),this.navbargetCartLength=!0})}else console.log("走更新"),console.log("走更新exitid[0]",o[0]),this.updateCart(o[0].id,o[0].product_id,o[0].qty+e)},updateCart(t,e,o){const a=`https://vue3-course-api.hexschool.io/api/chillstore_api/cart/${t}`;c.put(a,{data:{product_id:`${e}`,qty:o}}).then(r=>{console.log("updateCart-res",r),r.data.success&&(this.confirmupdateCart=!0)})},deleteOnecart(t){const e=`https://vue3-course-api.hexschool.io/api/chillstore_api/cart/${t}`;c.delete(e).then(o=>{console.log("deleteOnecart-res",o),o.data.success&&(this.confirmupdateCart=!0)})}}}),n=i("productsStore",{state:()=>({products:[],type:"產品列表",page:1,totalPage:1,rowData:[]}),getters:{sortType:t=>{let e=[];if(t.type==="產品列表"){const o=t.products;t.totalPage=Math.ceil(o.length/6),e=o.slice(t.page*6-6,t.page*6-1+1)}else{const o=t.products.filter(a=>a.category===t.type);t.totalPage=Math.ceil(o.length/6),e=o.slice(t.page*6-6,t.page*6-1)}return e}},actions:{getAlldata(t){const e=d(),o="https://vue3-course-api.hexschool.io/api/chillstore_api/products/all";console.log(o),c.get(o).then(a=>{console.log("res",a),a.data.success&&(console.log(a.data),this.products=a.data.products.map(r=>{const s=r.price<r.origin_price;return console.log("Isdiscount",s),{...r,Isdiscount:s}}),this.rowData=a.data.products.map(r=>{const s=r.price<r.origin_price;return console.log("Isdiscount",s),{...r,Isdiscount:s}}),e.getImgTrain(t))})}}});export{d as a,n as u};
