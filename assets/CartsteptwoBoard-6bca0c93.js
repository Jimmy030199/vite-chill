import{_ as y,r as x,s as V,u as k,m as M,a as v,c as g,d as e,F as $,b as S,t as w,z as L,g as u,h as a,x as C,k as b,j as U,A as P,e as h}from"./index-725eefef.js";import{a as F}from"./useproductsStore-13152138.js";import{M as R}from"./ModalAlert-79355eec.js";import{u as q}from"./usestatusStore-27766a8c.js";import"./modal-4b85e49e.js";const A={setup(){const c=x([]),t=()=>{const p="https://vue3-course-api.hexschool.io/api/chillstore_api/cart";L.get(p).then(l=>{l.data.success&&(c.value=l.data.data.carts)})},_=F(),{orderListId:s}=V(_),i=k();return M(c,()=>{c.value.length<1&&s===""&&i.push("/products/all")}),{finalCart:c,getCart:t}},created(){this.getCart()}},N={class:"col-12"},B={class:"table-responsive"},E=e("div",{class:"w-100 fs-4 bg-dark text-white ps-3"},"購物清單",-1),T={class:"table align-middle text-center"},z={class:"table-imgwarp"},D=["src"],j={class:"fw-bold no-wrap"},G={class:"fw-bold no-wrap"},H={class:"fw-bold no-wrap"};function J(c,t,_,s,i,p){return v(),g("div",N,[e("div",B,[E,e("table",T,[e("tbody",null,[(v(!0),g($,null,S(s.finalCart,(l,n)=>(v(),g("tr",{key:"finalCart"+n},[e("td",z,[e("img",{class:"table-img",src:l.product.imageUrl},null,8,D)]),e("td",j,w(l.product.title),1),e("td",G,w(l.qty)+"份",1),e("td",H,"$"+w(l.total)+"元",1)]))),128))])])])])}const K=y(A,[["render",J]]),O={setup(){const c=q(),t=F(),{alertModalmes:_,paybotton:s,isLoading:i}=V(c),{orderListId:p,navbargetCartLength:l}=V(t),n=x(null),m=()=>{console.log(r.value);const d={data:{user:{name:r.value.name,email:r.value.email,tel:r.value.phone,address:r.value.address},message:r.value.message}},o="https://vue3-course-api.hexschool.io/api/chillstore_api/order";i.value=!0,L.post(o,d).then(f=>{f.data.success&&(console.log("訂單發送成功",f.data.message,f.data.orderId),p.value=f.data.orderId,_.value={style:"bg-success text-white",title:f.data.message,content:`訂單發送成功您的訂單編號:${f.data.orderId}`,btn:{name:"確認",path:"/cart/step3"},close:!1},n.value.Modalshow(),i.value=!1,l.value=!0,s.value=!0)})},r=x({name:"",phone:"",email:"",address:"",paymethod:"",message:""});return{formValue:r,onSubmit:m,definePhoneRule:d=>d?/^09\d{2}-?\d{3}-?\d{3}$/.test(d)?!0:"需要正確的電話號碼":"收件人手機 為必填",Modalref:n,isLoading:i}},components:{ModalAlert:R}},Q={class:"col-12"},W={class:"row"},X={class:"col-6"},Y=e("label",{for:"name",class:"fs-5 fw-bold mb-1"},[e("span",{class:"text-danger fs-5"},"*"),h(" 收件人姓名：")],-1),Z={class:"col-6"},ee=e("label",{for:"phone",class:"fs-5 fw-bold mb-1"},[e("span",{class:"text-danger fs-5"},"*"),h(" 收件人手機:")],-1),se={class:"col-12 mt-2"},te=e("label",{for:"email",class:"fs-5 fw-bold mb-1"},[e("span",{class:"text-danger fs-5"},"*"),h(" 電子郵件：")],-1),ae={class:"col-12 mt-2"},oe=e("label",{for:"address",class:"fs-5 fw-bold mb-1"},[e("span",{class:"text-danger fs-5"},"*"),h(" 收件人地址：")],-1),le={class:"col-12 mt-2"},ne=e("label",{for:"paymethod",class:"fs-5 fw-bold mb-1"},[e("span",{class:"text-danger fs-5"},"*"),h(" 請選擇付款方式：")],-1),de=e("option",{selected:"",disabled:"",value:"",class:"text-secondary"},"請選擇付款方式",-1),ce=e("option",{value:"googlepay"},"GooglePay",-1),re=e("option",{value:"applepay"},"APPlePay",-1),ie=e("option",{value:"cash"},"現金支付",-1),me={class:"col-12 mt-2"},ue=e("label",{for:"paymethod",class:"fs-5 fw-bold mb-1"},"備註：",-1),_e=e("div",{class:"col-12 text-center mt-1"},[e("button",{type:"submit",class:"btn btn-outline-success btn-lg"},[e("i",{class:"bi bi-card-checklist"}),h("  確認送出")])],-1);function pe(c,t,_,s,i,p){const l=u("LoadingItem"),n=u("FieldItem"),m=u("ErrorMessage"),r=u("FormItem",!0),I=u("ModalAlert");return v(),g($,null,[a(l,{active:s.isLoading},null,8,["active"]),a(r,{onSubmit:s.onSubmit,class:"payform bg-secondary-subtle p-3 rounded"},{default:C(({errors:d})=>[e("div",Q,[e("div",W,[e("div",X,[Y,a(n,{modelValue:s.formValue.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.formValue.name=o),class:b([{"is-invalid":d.收件人姓名},"w-100"]),rules:"required",type:"text",name:"收件人姓名",id:"name",placeholder:" 請輸入姓名"},null,8,["modelValue","class"]),a(m,{name:"收件人姓名",class:"invalid-feedback text-danger fw-bold"})]),e("div",Z,[ee,a(n,{modelValue:s.formValue.phone,"onUpdate:modelValue":t[1]||(t[1]=o=>s.formValue.phone=o),rules:s.definePhoneRule,required:"",class:b([{"is-invalid":d.收件人手機},"w-100"]),type:"text",name:"收件人手機",id:"phone",placeholder:" 請輸入收件人手機"},null,8,["modelValue","rules","class"]),a(m,{name:"收件人手機",class:"invalid-feedback text-danger fw-bold"})])]),e("div",se,[te,a(n,{modelValue:s.formValue.email,"onUpdate:modelValue":t[2]||(t[2]=o=>s.formValue.email=o),rules:"email|required",class:b([{"is-invalid":d.電子郵件},"w-100"]),type:"text",name:"電子郵件",id:"email",placeholder:" 請輸入姓名"},null,8,["modelValue","class"]),a(m,{name:"電子郵件",class:"invalid-feedback text-danger fw-bold"})]),e("div",ae,[oe,a(n,{modelValue:s.formValue.address,"onUpdate:modelValue":t[3]||(t[3]=o=>s.formValue.address=o),rules:"required",class:b([{"is-invalid":d.收件人地址},"w-100"]),type:"text",name:"收件人地址",id:"address",placeholder:" 請輸入收件人地址"},null,8,["modelValue","class"]),a(m,{name:"收件人地址",class:"invalid-feedback text-danger fw-bold"})]),e("div",le,[ne,a(n,{modelValue:s.formValue.paymethod,"onUpdate:modelValue":t[4]||(t[4]=o=>s.formValue.paymethod=o),as:"select",rules:"required",name:"付款方式",class:b([{"is-invalid":d.付款方式},"w-100"]),id:"paymethod"},{default:C(()=>[de,ce,re,ie]),_:2},1032,["modelValue","class"]),a(m,{name:"付款方式",class:"invalid-feedback text-danger fw-bold"})]),e("div",me,[ue,U(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=o=>s.formValue.message=o),class:"w-100",placeholder:" 留言給我們"},null,512),[[P,s.formValue.message]])]),_e])]),_:1},8,["onSubmit"]),a(I,{ref:"Modalref"},null,512)],64)}const fe=y(O,[["render",pe]]),he={setup(){return{}},components:{CardFinalList:K,FormItem:fe}},be={class:"mt-5"},ve={class:"container pb-5"},ge={class:"row"},we={class:"mt-2 mb-5"},xe={class:"container"},Ve={class:"row px-2"};function ye(c,t,_,s,i,p){const l=u("CardFinalList"),n=u("FormItem");return v(),g($,null,[e("section",be,[e("div",ve,[e("div",ge,[a(l)])])]),e("section",we,[e("div",xe,[e("div",Ve,[a(n)])])])],64)}const ke=y(he,[["render",ye]]);export{ke as default};
